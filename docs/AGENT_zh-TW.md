# 基於大型語言模型的代理（ReAct）

## 什麼是代理人（ReAct）？

代理人是一種先進的人工智慧系統，以大型語言模型（LLMs）作為其核心計算引擎。它將大型語言模型的推理能力與規劃和工具使用等額外功能相結合，以自主執行複雜任務。代理人可以分解複雜的查詢，生成逐步解決方案，並與外部工具或 API 互動以蒐集資訊或執行子任務。

此範例使用 [ReAct（推理 + 行動）](https://www.promptingguide.ai/techniques/react)方法實現代理人。ReAct 使代理人能夠通過在迭代回饋迴路中結合推理和行動來解決複雜任務。代理人反覆進行三個關鍵步驟：思考、行動和觀察。它使用大型語言模型分析當前情況，決定下一步行動，使用可用的工具或 API 執行該行動，並從觀察結果中學習。這個持續的過程使代理人能夠適應動態環境，提高任務解決的準確性，並提供具有上下文感知的解決方案。

## 範例使用案例

一個使用 ReAct 的智能代理可以應用於各種場景，提供準確且高效的解決方案。

### 文字轉 SQL

使用者詢問「上一季度的總銷售額」。智能代理會解讀此請求，將其轉換為 SQL 查詢，對資料庫執行查詢，並呈現結果。

### 財務預測

一位財務分析師需要預測下一季度的收入。智能代理收集相關數據，使用財務模型進行必要的計算，並生成詳細的預測報告，確保預測的準確性。

## 使用代理功能

若要為您的客製化聊天機器人啟用代理功能，請按照以下步驟進行：

有兩種使用代理功能的方式：

### 使用工具使用

若要使用工具使用為您的客製化聊天機器人啟用代理功能，請按照以下步驟進行：

1. 導航至客製化機器人畫面中的代理區段。

2. 在代理區段中，您將找到可供代理使用的工具清單。預設情況下，所有工具都是禁用的。

3. 要啟用工具，只需切換所需工具旁邊的開關。一旦工具被啟用，代理將可以存取並在處理使用者查詢時使用該工具。

![](./imgs/agent_tools.png)

4. 例如，「網際網路搜尋」工具允許代理從網際網路獲取資訊以回答使用者問題。

![](./imgs/agent1.png)
![](./imgs/agent2.png)

5. 您可以開發和新增自己的客製化工具以擴展代理的功能。有關建立和整合客製化工具的更多資訊，請參考[如何開發您自己的工具](#how-to-develop-your-own-tools)部分。

### 使用 Bedrock 代理

您可以利用在 Amazon Bedrock 中建立的 [Bedrock 代理](https://aws.amazon.com/bedrock/agents/)。

首先，在 Bedrock 中建立一個代理（例如，透過管理主控台）。然後，在客製化機器人設定畫面中指定代理 ID。設定後，您的聊天機器人將利用 Bedrock 代理來處理使用者查詢。

![](./imgs/bedrock_agent_tool.png)

## 如何開發自己的工具

要為代理開發自訂工具，請遵循以下指南：

- 建立一個繼承自 `AgentTool` 類別的新類別。雖然介面與 LangChain 相容，但此範例實作提供自己的 `AgentTool` 類別，您應該從中繼承（[來源](../backend/app/agents/tools/agent_tool.py)）。

- 參考 [BMI 計算工具](../examples/agents/tools/bmi/bmi.py)的範例實作。此範例示範如何建立一個根據使用者輸入計算身體質量指數（BMI）的工具。

  - 工具上宣告的名稱和描述在 LLM 考慮要使用哪個工具回應使用者問題時會被使用。換句話說，它們會嵌入到提示中。因此建議盡可能精確地描述。

- [可選] 開發自訂工具後，建議使用測試腳本（[範例](../examples/agents/tools/bmi/test_bmi.py)）驗證其功能。此腳本將幫助您確保工具如預期運作。

- 完成自訂工具的開發和測試後，將實作檔案移動到 [backend/app/agents/tools/](../backend/app/agents/tools/) 目錄。然後開啟 [backend/app/agents/utils.py](../backend/app/agents/utils.py) 並編輯 `get_available_tools`，使用戶可以選擇開發的工具。

- [可選] 為前端新增清晰的名稱和描述。此步驟是可選的，但如果不執行此步驟，將使用工具中宣告的工具名稱和描述。它們是為 LLM 準備的，而非使用者，因此建議新增專門的解釋以提升使用者體驗。

  - 編輯 i18n 檔案。開啟 [en/index.ts](../frontend/src/i18n/en/index.ts) 並在 `agent.tools` 中新增您自己的 `name` 和 `description`。
  - 同時編輯 `xx/index.ts`。其中 `xx` 代表您希望的國家代碼。

- 執行 `npx cdk deploy` 部署您的變更。這將使您的自訂工具在自訂機器人畫面中可用。

## 貢獻

**歡迎為此工具儲存庫做出貢獻！** 如果您開發了一個有用且實作良好的工具，請考慮透過提交 issue 或 pull request 將其貢獻給專案。